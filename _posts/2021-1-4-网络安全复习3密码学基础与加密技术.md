---
title: 3密码学基础与加密技术
date: "2021-1-4 13:30:00 +0800"
tags: [网络安全复习]
---
# 密码学基础与加密技术
## 密码学的基本概念
### 基本术语
+ 明文(Plaintext)：要保密的消息
+ 加密(Encryption)：伪装消息隐藏内容的过程
+ 密文(Ciphertext)：加密后的消息
+ 解密(Decryption)：把密文转变为明文的过程 
+ 加密员或密码员(Cryptographer).
+ 密码算法(Cryptography Algorithm)：用于加密和解密的数学函数。
  + 加密采用的一组规则称作加密算法(Encryption Algorithm).
  + 解密所采用的一组规则称为解密算法(Decryption Algorithm).
### 加密通信的模型

![加密模型](/assets/resource/网络安全复习/加密.png)
### 密码体制
一个五元组（P,C,K,E,D)：

+ P（明文空间）：可能明文的有限集
+ C（密文空间）：可能密文的有限集
+ K（密钥空间）：可能密钥构成的有限集

任意 $k\in K$ ,有一个加密算法 $𝑒𝑘\in 𝐸$和相应的解密算法$𝑑𝑘\in 𝐷$，使得$𝑒𝑘:𝑃\longrightarrow 𝐶$ 和$𝑑𝑘:𝐶\longrightarrow 𝑃$ 分别为加密解密函数，满足$𝑑𝑘(𝑒𝑘(𝑥))=𝑥$, 这里$𝑥\in 𝑃$。

### 密码学本质
+ **密码算法**(Cryptography Algorithm)：用于加密和解密的数学函数
  + $c=E(m)，m=D(c)$
    $D(c)=E^{-1}(c)= E^{-1}(E(m))=m$
    加密和解密函数是一对可逆函数

+ 加解密**必要条件**：一对一映射（满的单射）

### 密码算法分类
![密码算法分类](/assets/resource/网络安全复习/算法分类.png)
+ 保密的内容
  + 算法保密性
  + 密钥保密性
    + 对称密码算法：**DES、AES**
    + 非对称密钥算法:*RSA、ECC*
+ 按照明文的处理方法
  + 分组密码: 将明文分成固定长度的组，用同一密钥和算法对每一块加密，输出也是固定长度的密文块
  + 流密码: 又称序列密码，每次加密一位或一字节的明文
### 密码分析
+ **目的**：利用密文发现明文；利用密文发现秘钥
+ **Kerckhoff原则**：破译者已知密码体制，即掌握加解密算法
+ 密码分析攻击
  + 唯密文攻击
    + 掌握一段或几段密文y，通过密文分析得出明文x或密钥k。主要穷举攻击
  + 已知明文攻击
    + 掌握一个或多个明文串x和相应的密文y， 或特定明文模式（如特定文件头格式，软件版权声明等），分析加密钥匙。
  + 选择明文攻击
    + 获得对加密机的暂时访问， 能选择明文串x并构造出相应的密文串y。差别比较分析法，加密一组差别细微的明文
  + 选择密文攻击
    + 暂时接近解密机，可选择任何密文串y，并构造出相应的明文x
### 密码算法的安全性
#### 无条件安全
+ 破译者掌握无限资源（计算、存储资源，密文等）也无法破译，即使破译了，也无法验证结果正确性.
+ Onetime pad，一次一密
#### 计算上安全
+ 对于拥有有限资源的破译者
+ 破译的代价超出信息本身的价值
+ 破译的时间超过信息的有效期
#### 可证明安全性

+ 算法安全性归结为某个已经过深入研究的数学难题。
  + 大数分解
  + 背包问题
## 密码技术的发展历史
### 古代加密方法(手工加密)
#### Scytale 密码
+ 一种早期的 希腊变换密码
+ 一张纸条环绕在一个圆柱上 
+ 消息沿着圆柱横写
+ 纸条上的字母看起来是一些随机字母
#### 几何图形密码
#### Polybius校验表（棋牌密码）
+ 公元前2世纪，希腊人Polybius设计
+ 将字母编码成符号对
### 古典密码（机械阶段）
#### 典型加密技术
+ 移形换位：代换与置换
+ 代换
  + 凯撒
    + 循环移位密码
  + 仿射($k_1，k_2，k_1$与26互素)
    + 加密：$c=Ek(m)=(k_1m + k_2)%26$
    + 解密：$m=Dk(c)=k_3(c- k_2) %26,（k_3×k_1）%26 = 1$
  + 棋盘
  + 单表
  + 多表
  + 置换技术:通过重排字母顺序隐藏信息
  + 栅栏技术:将明文按对角线方向写成若干行
  + 纵行换位:将明文按对角线方向写成若干行
  + 其他：暗号和隐语
  + **代换密码破译的三大要素**:
    + 重复特征
    + 频率特征
    + 连接特征
### 近代密码（计算阶段）
#### 密码算法迭代
+ 连续使用多种加密算法，可以提供更高的安全性，例如代换和置换
+ 乘积密码
+ 迭代密码
### 对称加密算法
#### 加密通信模型
![加密通信模型](/assets/resource/网络安全复习/加密通信模型.png)
#### DES(Data Encryption Standard)算法
+ 适宜硬件实现，处理速度远超软件实现。
+ 衍生出可抗差分分析攻击的变形DES以及密钥长度为128比特的三重DES等。 
+ 在POS、ATM、磁卡及智能卡（IC卡）、加油站、高速公路收费站等领域被广泛应用
  + 如信用卡持卡人PIN的加密传输
  + IC卡与POS间的双向认证

**DES算法原理**:
+ 三个入口参数：Key、Data、%e。
  + Key：8byte共64bit，有效56bit；
  + Data：8byte共64bit；
  + %e：加密或解密。

**DES完整一轮迭代**:
![DES](/assets/resource/网络安全复习/DES.png)
+ DES算法存在的问题与挑战
  + 强力攻击：$2^{55}$次尝试      
  + 差分密码分析法（Shamir）：$2^{47}$次尝试
  + 线性密码分析法：$2^{43}$次尝试
#### 高级加密标准(AES) 
+ 公开；
+ 对称分组密码；
+ 钥匙长度动态可变：128、192、256
+ 可软硬件实现。

![AES](/assets/resource/网络安全复习/AES.png)

### 分组密码加密模式
+ 大数加密问题：
  + 保持各分组内容的完整
  + 保持各分组的次序不变
+ 加密算法不仅要包括加密算法本身，还需要带有某种大数加密机制。
+ 根据加密分组间的关联方式，可以分为五+ 种加密模式。
#### 电子代码本（ECB-Electronic Code Book）模式 
+ 分组依次独立加密，产生独立密文分组，各分组加密结果互不影响
+ 优点：
  + 简单
  + 利于并行
  + 误差不传送
  + 适合传输长度短的报文
+ 缺点：
  + 不隐藏明文模式：相同明文分组产生相同分组
  + 可主动攻击：密文内容若遭剪贴、替换，也不易被发现
![电子代码本](/assets/resource/网络安全复习/电子代码本.png)

#### 密码块链模式 （CBC-Cipher Block Chaining）
![密码块链模式](/assets/resource/网络安全复习/密码块链模式.png)
+ 优点：
  + 隐藏了明文模式；
  + 不容易主动攻击，安全性好于ECB
  + 适合传输长度长的报文
  + 是SSL、IPSec的标准。
+ 缺点：
  + 不利于并行
  + 误差传递
  + 需IV
#### 密文反馈模式 （CFB-Cipher text Feedback）
+ 前一个密文分组作为输入向量加密后当前明文分组异或
![密文反馈模式](/assets/resource/网络安全复习/密文反馈模式.png)

#### 输出反馈模式 （OFB-Output Feedback）
+ 前一加密结果作为当前加密的输入向量
+ 前一加密结果与当前明文分组异或产生密文分组

#### 计数器模式（Counter (CTR)）
+ 计数器值加密与明文异或，计数器值依次递增1
### 公开密钥体制
#### 问题提出
+ 对称密码体制密钥管理困难
+ 对称加密算法无法实现抗抵赖的需求
#### 公开密钥密码体制的提出
1976 Stanford大学Diffie和Hellman在“密码学发展新动向”一文中首次提出公开密钥（非对称）密码体制思想

+ 每个用户拥有（产生）一对密钥
+ 加解密算法公开
+ 两个密钥中任何一个都可以用作加密，而另一个用作解密
#### 公钥密码体制的安全基础
+ 安全性主要基于数学中的难解问题
+ 最流行的有两大类
  + 基于大整数因子分解问题：比如RSA体制、Rabin体制等
  + 基于离散对数问题：如ElGamal体制、椭圆曲线密码体制
#### 基本思想和要求
+ 涉及到各方：**发送方**、**接收方**、**攻击者**
+ 涉及到数据：公钥、私钥、明文、密文
+ 公钥算法的条件：
  + 产生一对密钥计算可行
  + 用公钥加密计算可行
  + 用私钥解密计算可行
  + 对于攻击者，用公钥推断私钥计算不可行
  + 已知公钥和密文，恢复明文计算不可行的
  + (可选)加密和解密的顺序可交换
#### 单向函数(One-way)
一函数$f:(A \to B)$若满足下列条件，则称$f$为单向函数：
+ 对于所有$x \in A$，易于计算$f(x)$
+ 对“几乎所有$x \in A$由$f(x)$求$x$极为困难，以至于实际上不可能做到
#### 陷门单向函数
+ 单向函数求逆困难，陷门单向函数求逆容易
  + 在不知陷门信息下求逆困难的函数
  + 当知道陷门信息后，求逆是易于实现的

#### 数论知识
+ 模n逆元：
  + 若a，n互素，$a\times b \% n =1，a，b$为模$n$逆元
  + $a\times b=k\times n+1$；如$3\times9\%26=1$
  + Euclid算法求乘法逆元
+ Euler函数$\Phi (n)$ ：
  + 小于n且与n互素的正整数的个数，$n>1$
    + $\Phi (3)= \Phi (4) = \Phi (6) =2, \Phi (5)=4$
  + 若n是素数，则$\Phi (n)=n-1$
    + $\Phi(5)=4，\Phi(7) =6$
  + 若$n=p*q，p、q$是素数，则$\Phi (n)=(p-1)*(q-1)$
+ 模运算（同余）性质：**自反性、对称性、传递性**
  + $a ≡ a \% n$
+ 分配律
  + $(a + b) \% n ≡ [(a \% n) +(b \% n)]\% n$
+ Euler定理
  + 若m与n互素，则$m^{φ(n)}  \% n =1$,即$m^{φ(n)+1}  \% n =m$
  + 解密:$c^y\%n=(m^x)^y \%n=m^{x.y}\%n=m$
  + 基于此构造xy的逆元关系: $x.y\% \Phi (n)\equiv 1$
#### RSA的提出
+ 基本思想：
  + 加密：$m^x=c$
  + 解密：$c^y=(m^x)^y=m^{xy}=m$
  + 逆元：x，y互为某种乘法逆元
+ 幂运算+模运算，利用数论中大整数分解的困难性
  + 加密：$m^x\%n=c$
  + 解密： $c^y\%n=(m^x)^y \%n=m$
  + 问题：$x·y??=1$，即x，y如何互为逆元
#### RSA 计算
1. 独立随机选取两大素数p和q，保密
2. 计算模数$n=p\times q$
3. 计算欧拉函数$\Phi (n)=(p－1)(q－1)$，保密并销毁p和q
4. 随机选一整数$e，1\le e<\Phi(n)，gcd(\Phi(n), e)=1，$以$n、e$为公钥，公开
5. 计算出d，使之满足$d\times e \% \Phi(n) ≡1$，以d为私钥
#### RSA缺点
+ 运算速度慢：RSA最快也比DES慢上100倍
+ 产生密钥烦琐

素数的产生：
**随机**产生一个大奇数，然后测试其是否满足条件
#### 加密功能的实施方式
+ 端到端加密：在网络层及以上或者应用层实施加密机制
  + 在发送端和中间节点上数据都是加密的，安全性好 
  + 能提供用户（主机、进程）鉴别
  + 低成本
  + 不能提供流量保密性（信封不加密） 
  + 密钥管理系统复杂 
  + 加密是离线的
+ 链到链加密：在物理层或数据链路层实施加密机制
  + 通信节点维护加密设施
  + 对用户透明
  + 能提供流量保密性（加填充）
  + 密钥管理简单
  + 可提供主机鉴别 （解密鉴别）
  + 加/解密是在线
  + 数据仅在传输线路上是加密
  + 每段链路使用不同的密钥加解密，每个结点都需一套加解密设备，开销大
+ 链到链加密与端到端加密的结合
